services:
  opencloud:
    image: opencloudeu/opencloud-rolling:latest
    container_name: opencloud-video-review
    ports:
      - "9200:9200"
    entrypoint: ["/bin/sh", "-c"]
    command: ["opencloud init || true; opencloud server"]
    environment:
      OC_URL: https://localhost:9200
      OC_INSECURE: "true"
      OC_LOG_LEVEL: warn
      IDM_CREATE_DEMO_USERS: "true"
      IDM_ADMIN_PASSWORD: admin
      PROXY_ENABLE_BASIC_AUTH: "true"
      WEB_ASSET_APPS_PATH: /web/apps
      WEB_UI_CONFIG_FILE: /etc/opencloud/web.json
      PROXY_CSP_CONFIG_FILE_LOCATION: /etc/opencloud/csp.yaml
    volumes:
      - ocdata:/etc/opencloud
      - ./dist:/web/apps/video-review
      - ./dev/config/csp.yaml:/etc/opencloud/csp.yaml:ro
      - ./dev/config/web.json:/etc/opencloud/web.json:ro
volumes:
  ocdata:
